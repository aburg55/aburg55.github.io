<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Survey</title>
  <style>
    html, body { height: 100%; margin: 0; }
    #formDiv { height: 100%; }
  </style>

  <!-- Survey123 Web App JavaScript API -->
  <script src="https://survey123.arcgis.com/api/jsapi/"></script>
</head>
<body>
  <div id="formDiv"></div>

  <script>
    const SURVEY_ITEM_ID = "d4f003f5be254f9bb5a8d92a281f9e13";
    const RESULT_PAGE = "https://aburg55.github.io/testPage.html";

    const webform = new Survey123WebForm({
      container: document.getElementById("formDiv"),
      itemId: SURVEY_ITEM_ID
    });

    webform.onFormSubmitted = (e) => {
      console.log("onFormSubmitted event:", e);

      // Try common payload shapes (varies by version)
      const globalId =
        e?.globalId ||
        e?.result?.globalId ||
        e?.feature?.attributes?.globalid ||
        e?.feature?.attributes?.GlobalID;

      const objectId =
        e?.objectId ||
        e?.result?.objectId ||
        e?.feature?.attributes?.objectid ||
        e?.feature?.attributes?.OBJECTID;

      if (globalId) {
        window.location.href = `${RESULT_PAGE}?gid=${encodeURIComponent(globalId)}`;
        return;
      }

      if (objectId) {
        window.location.href = `${RESULT_PAGE}?oid=${encodeURIComponent(objectId)}`;
        return;
      }

      alert("Submitted, but could not read globalId/objectId from the submission event. Open DevTools Console to inspect the event payload.");
    };
  </script>
</body>
</html>
